<?php/*------------------------------------------------------------------TABLE OF CONTENTS1 - Panel Options2 - Theme Collections3 - Shortcode Generator------------------------------------------------------------------*//*------------------------------------------------------------------	1 - Panel Options------------------------------------------------------------------*/class Gae_Option_Panel {		protected $_gae_panel;	function __construct($option_panel) {		$this->_gae_panel = $option_panel;		add_action('admin_init', array(&$this, 'load_scripts'));		add_action('admin_init', array(&$this, 'options_init'));		add_action('admin_menu', array(&$this, 'add_submenu'));		add_action('wp_before_admin_bar_render', array(&$this, 'add_admin_bar'));		add_action('in_admin_footer', array(&$this, 'add_scripts'));		add_action('switch_theme', array(&$this, 'options_remove'));	}		function load_scripts(){		global $pagenow;		if( $pagenow != 'admin.php' ) return;		if( $_GET['page'] == $this->_gae_panel['id'] ) :			wp_enqueue_script( 'jquery' );			wp_enqueue_script( 'jquery-ui-tabs' );			wp_enqueue_script( 'farbtastic' );			wp_enqueue_script( 'thickbox' );			wp_enqueue_script( 'media-upload' );			wp_enqueue_script( 'jquery-cookie', get_theme_uri('functions, gaepanel, js') . '/jquery.cookie.js', '', '1' );			wp_enqueue_script( 'jquery-ui-custom', get_theme_uri('functions, gaepanel, js') . '/jquery-ui.custom.min.js', '', '1' );			wp_enqueue_script( 'jquery-ui-timepicker', get_theme_uri('functions, gaepanel, js') . '/jquery-ui.timepicker.js', '', '1' );			wp_enqueue_script( 'admin-options', get_theme_uri('functions, gaepanel, js') . '/jquery.options.js', '', '1' );			wp_enqueue_style( 'farbtastic' );			wp_enqueue_style( 'thickbox' );			wp_enqueue_style(' tabber' );			wp_enqueue_style( 'gaepanel', get_theme_uri('functions, gaepanel, css') . '/gaepanel.css', '', '1', false, 'screen');			wp_enqueue_style( 'jquery-ui-custom', get_theme_uri('functions, gaepanel, css') . '/jquery-ui.custom.css', '', '1', false, 'screen');		endif;	}	function options_init(){		global $shortname;		if ( false == $this->options_default() )			add_option( $shortname.'_options_'.$this->_gae_panel['key'], $this->options_default() );		register_setting( $shortname.'_options_'.$this->_gae_panel['key'], $shortname.'_options_'.$this->_gae_panel['key'], array(&$this, 'options_validate') );	}    function add_submenu() {		global $themename;		if( is_array($this->_gae_panel['parent'])) {			$parent = $this->_gae_panel['parent'];			add_menu_page ( $this->_gae_panel['id'], ( isset($parent['name']) ? $parent['name'] : $themename ), $this->_gae_panel['capability'], $this->_gae_panel['id'], array(&$this, 'display_page'), ( isset($parent['icon']) ? esc_url($parent['icon']) : '' ), ( isset($parent['position']) ? absint($parent['position']) : 101 ) );			add_submenu_page( $this->_gae_panel['id'], $this->_gae_panel['title'], $this->_gae_panel['page'], $this->_gae_panel['capability'], $this->_gae_panel['id'], array(&$this, 'display_page') );		} else {			add_submenu_page( $this->_gae_panel['parent'], $this->_gae_panel['title'], $this->_gae_panel['page'], $this->_gae_panel['capability'], $this->_gae_panel['id'], array(&$this, 'display_page') );		}	}		function add_admin_bar() {		global $wp_admin_bar, $themename;		if ( is_admin() || !is_admin_bar_showing() || !current_user_can($this->_gae_panel['capability']) ) return;		if( is_array($this->_gae_panel['parent'])) {			$parent = $this->_gae_panel['parent'];			$wp_admin_bar->add_menu( array( 'id' => $this->_gae_panel['id'], 'parent' => '', 'title' => ( isset($parent['name']) ? $parent['name'] : $themename ), 'href' => admin_url('admin.php?page='. $this->_gae_panel['id']) ) );			$wp_admin_bar->add_menu( array( 'id' => $this->_gae_panel['id'] .'-'. $this->_gae_panel['key'], 'parent' => $this->_gae_panel['id'], 'title' => $this->_gae_panel['page'], 'href' => admin_url('admin.php?page='. $this->_gae_panel['id']) ) );					} else {			$wp_admin_bar->add_menu( array( 'id' => $this->_gae_panel['id'] .'-'. $this->_gae_panel['key'], 'parent' => $this->_gae_panel['parent'], 'title' => $this->_gae_panel['page'], 'href' => admin_url('admin.php?page='. $this->_gae_panel['id']) ) );		}	}		function options_validate( $input ) {		foreach ($this->_gae_panel['options'] as $value) {			$id = ( isset($value['id']) ) ? $value['id'] : '';			$std = ( isset($value['std']) ) ? $value['std'] : '';			switch ( $value['type'] ) {				case "text":				case "file":				case "checkbox":				case "select":				case "radio":				case "time":					$input[$id] = wp_filter_nohtml_kses( $input[$id] );				break;								case "number":					$input[$id] = absint( $input[$id] );				break;								case "color":					$color = preg_replace('/[^0-9a-fA-F]/', '', wp_filter_nohtml_kses( $input[$id] ));					if ( strlen($color) == 6 || strlen($color) == 3 )						$input[$id] = wp_filter_nohtml_kses( $input[$id] );					else						$input[$id] = '#';				break;								case "textarea":				case "checkboxes":					$input[$id] = $input[$id];				break;					case "skin":					$input[$id] = ($input[$id]) ? $input[$id] : $std;				break;								case "accounts":					$input[$id][] = wp_filter_nohtml_kses( $input[$id] );				break;				}		}		return $input;	}	function options_default() {		global $shortname;		$theme_options 	= $this->_gae_panel['options'];		$get_theme_options 	= get_option( $shortname.'_options_'.$this->_gae_panel['key'] );				if( empty($get_theme_options) || ( ( array_key_exists('page', $_REQUEST) && $_REQUEST['page'] == $this->_gae_panel['id'] ) && ( array_key_exists('settings-updated', $_REQUEST) && $_REQUEST['settings-updated'] == 'false' ) ) ) {			foreach ($theme_options as $value) {				$id = ( isset($value['id']) ) ? $value['id'] : '';				$std = ( isset($value['std']) ) ? $value['std'] : '';				switch ( $value['type'] ) {					case "text":					case "number":					case "color":					case "file":					case "textarea":					case "select":					case "radio":					case "checkbox":					case "skin":					case "time":					case "accounts":						$defaults[$id] = $std;					break;						case "checkboxes":						foreach ($std as $val) {							$defaults[$id][] = $val;						}					break;					}			}			return update_option($shortname . '_options_'.$this->_gae_panel['key'], $defaults);		}	}		function display_page() {		global $shortname, $themename;				$options 	= get_option($shortname . '_options_'.$this->_gae_panel['key']);		$nav		= '';		$content	= '';				foreach ($this->_gae_panel['options'] as $value) {			$id 	= isset($value['id']) ? $value['id'] : '';			$id_id 	= $shortname .'_option_'. $id;			$theme_id	= $shortname . '_options_'.$this->_gae_panel['key'].'['. $id .']';			$val_std	= ( isset($value['std']) ) ? $value['std'] : '';			switch ( $value['type'] ) {				case "tab_begin":					$nav .= '<li><a class="id-'. $id .'" href="#'. $id .'">'. ( isset($value['name']) ? $value['name'] : '' ) .'</a></li>'. "\n";					$content .= '<div class="tab-content hide-if-js" id="'. $id .'">'. "\n";					$content .= '<h3 class="title"><span>'. ( isset($value['name']) ? sprintf( __('%s Setting', 'gaetheme'), $value['name'] ) : '' ) .'</span></h3>'. "\n";				break;									case "tab_end":					$content .= '<p class="to-top hide-if-js"><a href="#">to top</a></p>'. "\n";					$content .= '</div>'. "\n";				break;									case "text":					$content .= '<div id="'. $id .'" class="element element-'. $value['type'] .'">'. "\n";					$content .= '<label for="'. $id_id .'">'. ( isset($value['name']) ? $value['name'] : '' ) .'</label><br class="clear">'. "\n";					$content .= '<div class="main-col">'. "\n";					$content .= '<input class="'. $value['type'] .' widefat" type="text" name="'. $theme_id .'" id="'. $id_id .'" '. ( !empty($value['lock']) ? 'disabled="disabled" value="'. ( isset($value['std']) ? esc_attr($value['std']) : '' ) .'"' : '' ) . ( (empty($value['lock']) && isset($options[$id])) ? 'value="'. esc_attr($options[$id]) .'"' : '' ) .'/>'. "\n";					$content .= '</div>'. "\n";					$content .= ( isset($value['desc']) ? '<div class="desc-col"><small>'. $value['desc'] .'</small></div>'. "\n" : '' );					$content .= '</div><br class="clear">'. "\n";				break;								case "number":					$content .= '<div id="'. $id .'" class="element element-'. $value['type'] .'">'. "\n";					$content .= '<label for="'. $id_id .'">'. ( isset($value['name']) ? $value['name'] : '' ) .'</label><br class="clear">'. "\n";					$content .= '<div class="main-col">'. "\n";					$content .= '<input class="'. $value['type'] .' widefat" size="5" type="text" name="'. $theme_id .'" id="'. $id_id .'" '. ( !empty($value['lock']) ? 'disabled="disabled" value="'. ( isset($value['std']) ? esc_attr($value['std']) : '' ) .'"' : '' ) . ( (empty($value['lock']) && isset($options[$id])) ? 'value="'. absint( $options[$id] ) .'"' : '' ) .'/>'. "\n";					$content .= '</div>'. "\n";					$content .= ( isset($value['desc']) ? '<div class="desc-col"><small>'. $value['desc'] .'</small></div>'. "\n" : '' );					$content .= '</div><br class="clear">'. "\n";				break;				case "color":					$content .= '<div id="'. $id .'" class="element element-'. $value['type'] .'">'. "\n";					$content .= '<label for="'. $id_id .'">'. ( isset($value['name']) ? $value['name'] : '' ) .'</label><br class="clear">'. "\n";					$content .= '<div class="main-col">'. "\n";					$content .= '<div class="'. $id .'">'. "\n";					$content .= '<input class="color-value" type="text" name="'. $theme_id .'" id="'. $id_id .'" '. ( !empty($value['lock']) ? 'disabled="disabled" value="'. ( isset($value['std']) ? esc_attr($value['std']) : '' ) .'"' : '' ) . ( (empty($value['lock']) && isset($options[$id])) ? 'value="'. esc_attr( $options[$id] ) .'"' : '' ) .'/>'. "\n";					$content .= '<input '. ( empty($value['lock']) ? 'type="button"' : 'type="text" disabled="disabled"' ) .' class="color-preview hide-if-no-js"></input>'. "\n";					$content .= '<input class="color-select hide-if-no-js" type="button" value="'. __('Select a Color', 'gaetheme') .'" />';					$content .= '<input class="color-remove" type="button" value="'. __('Clear', 'gaetheme') .'" />';					$content .= ( empty($value['lock']) ? "<div class='colorpicker'></div><script type='text/javascript'>jQuery(document).ready(function($) { jQuery('.". $id ."').gaeColor({pickClass : 'colorpicker'}); });</script>" : '' );					$content .= '</div>'. "\n";					$content .= '</div>'. "\n";					$content .= ( isset($value['desc']) ? '<div class="desc-col"><small>'. $value['desc'] .'</small></div>'. "\n" : '' );					$content .= '</div><br class="clear">'. "\n";				break;				case "file":					$file_img = isset($options[$id]) ? esc_url( $options[$id] ) : '';					$content .= '<div id="'. $id .'" class="element element-'. $value['type'] .'">'. "\n";					$content .= '<label for="'. $id_id .'">'. ( isset($value['name']) ? $value['name'] : '' ) .'</label><br class="clear">'. "\n";					$content .= '<div class="main-col">'. "\n";					$content .= '<div class="'. $id .'">'. "\n";					$content .= '<input class="file-input'. ( !empty($file_img) ? ' previewed" value="'. $file_img : '') .'" id="'. $id_id .'" type="text" name="'. $theme_id .'"/>'. "\n";					$content .= '<input class="file-button hide-if-no-js" type="button" value="'. __('Upload', 'gaetheme') .'" />';					$content .= '<input class="file-remove hide-if-no-js" type="button" value="'. __('Clear', 'gaetheme') .'" '. ( !empty($file_img) ? 'style="display: inline;"' : '') .'/>';					$content .= '<div class="file-preview">'. ( !empty($file_img) ? '<img src="'. $file_img .'" alt="" />' : '' ) .'</div>'. "\n";					$content .= '</div>'. "\n";					$content .= '</div>'. "\n";					$content .= ( isset($value['desc']) ? '<div class="desc-col"><small>'. $value['desc'] .'</small></div>'. "\n" : '' );					$content .= "<script type='text/javascript'> jQuery(document).ready(function($) { jQuery('#". $id ."').gaePreviewFile(); }); </script>". "\n";					$content .= '</div><br class="clear">'. "\n";				break;							case "time":					$format = explode(" ", $value['format']);					$content .= '<div id="'. $id .'" class="element element-'. $value['type'] .'">'. "\n";					$content .= '<label for="'. $id_id .'">'. ( isset($value['name']) ? $value['name'] : '' ) .'</label><br class="clear">'. "\n";					$content .= '<div class="main-col">'. "\n";					$content .= '<input class="time widefat" type="text" id="'. $id_id .'" name="'. $theme_id .'" '. ( isset($options[$id]) ? 'value="'. esc_attr( $options[$id] ) .'"' : '' ) .'/>'. "\n";					$content .= '</div>'. "\n";					$content .= ( isset($value['desc']) ? '<div class="desc-col"><small>'. $value['desc'] .'</small></div>'. "\n" : '' );					$content .= "<script type='text/javascript'> jQuery(document).ready(function($) { $('#". $id_id ."').each(function(){ $(this).datetimepicker({ dateFormat: '". trim($format['0']) ."', timeFormat: '". trim($format['2']) ."', separator: ' ". trim($format['1']) ." ' }); }); }); </script>";					$content .= '</div><br class="clear">'. "\n";				break;				case "textarea":					$content .= '<div id="'. $id .'" class="element element-'. $value['type'] .'">'. "\n";					$content .= '<label for="'. $id_id .'">'. ( isset($value['name']) ? $value['name'] : '' ) .'</label><br class="clear">'. "\n";					$content .= '<div class="main-col">'. "\n";					$content .= '<textarea class="textarea widefat" id="' . $id_id . '" name="' . $theme_id . '" cols="35" rows="5">'. "\n";					$content .= ( isset($options[$id]) ? esc_textarea( $options[$id] ) : '' );					$content .= '</textarea>'. "\n";					$content .= '</div>'. "\n";					$content .= ( isset($value['desc']) ? '<div class="desc-col"><small>'. $value['desc'] .'</small></div>'. "\n" : '' );					$content .= '</div><br class="clear">'. "\n";				break;							case "select":					$content .= '<div id="'. $id .'" class="element element-'. $value['type'] .'">'. "\n";					$content .= '<label for="'. $id_id .'">'. ( isset($value['name']) ? $value['name'] : '' ) .'</label><br class="clear">'. "\n";					$content .= '<div class="main-col">'. "\n";					$content .= '<select class="select" name="'. $theme_id .'" id="'. $id_id .'" '. ( !empty($value['lock']) ? 'disabled="disabled"' : '' ) .'>'. "\n";					foreach ( $value['options'] as $get_opt ) {						$content .= '<option value="'. $get_opt['val'] .'" '. ( ( (empty($value['lock']) && isset($options[$id]) && $options[$id] == $get_opt['val']) || (!empty($value['lock']) && $val_std == $get_opt['val']) ) ? ' selected="selected"' : '' ) .'>'. $get_opt['name'] .'</option>'. "\n";					}					$content .= '</select>'. "\n";					$content .= '</div>'. "\n";					$content .= ( isset($value['desc']) ? '<div class="desc-col"><small>'. $value['desc'] .'</small></div>'. "\n" : '' );					$content .= '</div><br class="clear">'. "\n";				break;							case "radio":					$content .= '<div id="'. $id .'" class="element element-'. $value['type'] .'">'. "\n";					$content .= '<label>'. ( isset($value['name']) ? $value['name'] : '' ) .'</label><br class="clear">'. "\n";					$content .= '<div class="main-col">'. "\n";					$content .= '<ul class="radio">'. "\n";					foreach ($value['options'] as $get_opt) {						$content .= '<li><input type="radio" name="'. $theme_id .'" value="'. $get_opt['id'] .'" id="'. $get_opt['id'] .'" ' .( !empty($value['lock']) ? 'disabled="disabled"' : '' ) . ( ( (empty($value['lock']) && isset($options[$id]) && $options[$id] == $get_opt['id']) || (!empty($value['lock']) && $val_std == $get_opt['id']) ) ?' checked="yes"' : '' ) .'/> <label for="'.$get_opt['id'] .'">'. $get_opt['name'] .'</label></li>'. "\n";					}					$content .= '</ul>'. "\n";					$content .= '</div>'. "\n";					$content .= ( isset($value['desc']) ? '<div class="desc-col"><small>'. $value['desc'] .'</small></div>'. "\n" : '' );					$content .= '</div><br class="clear">'. "\n";				break;							case "checkbox":					$content .= '<div id="'. $id .'" class="element element-'. $value['type'] .'">'. "\n";					$content .= '<label>'. ( isset($value['name']) ? $value['name'] : '' ) .'</label><br class="clear">'. "\n";					$content .= '<div class="main-col">'. "\n";					$content .= '<ul class="checkbox">'. "\n";					$content .= '<li><input type="checkbox" name="'. $theme_id .'" value="true" id="'. $id_id .'" '. ( !empty($value['lock']) ? 'disabled="disabled"' : '' ) . ( ( empty($value['lock']) && $options[$id] == 'true' || !empty($value['lock']) && $val_std == 'true' ) ? ' checked="checked"' : '' ) .'/> <label for="'. $id_id .'">'. $value['options'] .'</label></li>'. "\n";					$content .= '</ul>'. "\n";					$content .= '</div>'. "\n";					$content .= ( isset($value['desc']) ? '<div class="desc-col"><small>'. $value['desc'] .'</small></div>'. "\n" : '' );					$content .= '</div><br class="clear">'. "\n";				break;							case "checkboxes":					$content .= '<div id="'. $id .'" class="element element-'. $value['type'] .'">'. "\n";					$content .= '<label>'. ( isset($value['name']) ? $value['name'] : '' ) .'</label><br class="clear">'. "\n";					$content .= '<div class="main-col">'. "\n";					$content .= '<ul class="checkboxes">'. "\n";					foreach ($value['options'] as $get_opt) {						$id_value = str_replace('*','',str_replace(' ','_',strtolower($get_opt)));						$content .= '<li><input type="checkbox" name="'. $theme_id .'[]" value="'. $id_value .'" id="'. $id_value .'"';						if ( !empty($value['lock']) ) {							$content .= ' disabled="disabled"';							foreach ($val_std as $std) {								if ( $std == $id_value ) { 									$content .= ' checked="checked"'; 								}							}						}						if ( isset($options[$id]) ) {							foreach ($options[$id] as $selected) {								if ( $selected == $id_value ) { 									$content .= ' checked="checked"'; 								}							}						}						$content .= '/> <label for="'. $id_value .'">'. $get_opt .'</label></li>'. "\n";					}					$content .= '</ul>'. "\n";					$content .= '</div>'. "\n";					$content .= ( isset($value['desc']) ? '<div class="desc-col"><small>'. $value['desc'] .'</small></div>'. "\n" : '' );					$content .= '</div><br class="clear">'. "\n";				break;							case "skin":					$content .= '<div id="'. $id .'" class="element element-'. $value['type'] .'">'. "\n";					$content .= '<ul class="radio skin">'. "\n";					$i = 1;					foreach ($value['options'] as $get_opt) {						$id_value = str_replace(',','',str_replace(' ','_',strtolower($get_opt)));						$img_src = file_exists(get_theme_dir('skins') .'/'. $id_value .'/screenshot.png') ? get_theme_uri('skins') .'/'. $id_value .'/screenshot.png' : get_theme_uri() .'/screenshot.png';						$class = ( $i%2==0 ) ? 'even' : 'odd';						$content .= '<li class="'. ( ( $i%2==0 ) ? 'even' : 'odd' ) . ( (!empty($value['lock']) && $val_std != $id_value) ? ' disabled' : '' ) . ( ( (empty($value['lock']) && isset($options[$id]) && $options[$id] == $id_value) || (!empty($value['lock']) && $val_std == $id_value) ) ? ' selected' : '' ) .'"><label for="'.$id_value .'"><img src="'. $img_src .'" alt="'. $get_opt .'" /><input type="radio" class="hide-if-js" name="'. $theme_id .'" value="'. $id_value .'" id="'. $id_value .'" '. ( !empty($value['lock']) ? 'disabled="disabled"' : '' ) . ( ( (empty($value['lock']) && isset($options[$id]) && $options[$id] == $id_value) || (!empty($value['lock']) && $val_std == $id_value) ) ? ' checked="yes"' : '' ) .'/> '. $get_opt .'</label>';						$content .= '</li>'. "\n";						$i = $i+1;					}					$content .= '</div><br class="clear">'. "\n";				break;							case "accounts":					$content .= '<div id="'. $id .'" class="element element-'. $value['type'] .'">'. "\n";					$content .= '<span class="button add-account hide-if-no-js">'. __('Add New Account', 'gaetheme') .'</span>'. "\n";					$content .= '<label>'. ( isset($value['name']) ? $value['name'] : '' ) .'</label><br class="clear">'. "\n";					$content .= '<p class="howto hide-if-js">'. __('You can add new fields if the JavaScript is enabled in your web browser.', 'gaetheme') .'</p>'. "\n";					$content .= '<div class="main-col">'. "\n";					$content .= '<div class="social-accounts">'. "\n";					foreach ($options[$id] as $key=>$social) {						if( !empty($social['name']) && !empty($social['url']) ) {							$content .= '<h4 class="account-title account-'.$key .'" onclick="gaeEditAccount('.$key .');">'. $social['name'] .' <span class="edit hide-if-no-js"></span><span class="remove hide-if-no-js"><a onclick="gaeDelAccount('.$key .');" class="account-'.$key .'">'. __('Remove', 'gaetheme') .'</a></span></h4>';							$content .= '<div class="account-data hide-if-js account-'.$key .'">'. "\n";							$content .= '<ul>'. "\n";							$content .= '<li class="odd"><label for="account-name-'. $key .'">'. __('Name', 'gaetheme') .'</label></li>'. "\n";							$content .= '<li class="even"><input name="'. $theme_id .'['.$key .'][name]" id="account-name-'. $key .'" type="text" class="social-name text" value="'. ( isset($social['name']) ? esc_attr( $social['name'] ) : '' ) .'" /></li>'. "\n";							$content .= '</ul>'. "\n";							$content .= '<ul>'. "\n";							$content .= '<li class="odd"><label for="account-url-'. $key .'">'. __('URL', 'gaetheme') .'</label></li>'. "\n";							$content .= '<li class="even"><input name="'. $theme_id .'['.$key .'][url]" id="account-url-'. $key .'" type="text" class="social-url text" value="'. ( isset($social['url']) ? esc_url( $social['url'] ) : '' ) .'" /></li>'. "\n";							$content .= '</ul>'. "\n";							$content .= '<ul>'. "\n";							$content .= '<li class="odd"><label for="account-icon-'. $key .'">'. __('Icon', 'gaetheme') .'</label></li>'. "\n";							$content .= '<li class="even"><input name="'. $theme_id .'['.$key .'][icon]" id="account-icon-'. $key .'" type="text" class="social-icon text" value="'. ( isset($social['icon']) ? esc_url( $social['icon'] ) : '' ) .'" />'. ( isset($social['icon']) ? "\n" .'<img src="'. esc_url( $social['icon'] ) .'" alt=""/>' : '' ) .'</li>'. "\n";							$content .= '</ul>'. "\n";							$content .= '<br class="clear"></div>'. "\n";						}					}					$content .= '</div>'. "\n";					$content .= '</div>'. "\n";					$content .= ( isset($value['desc']) ? '<div class="desc-col"><small>'. $value['desc'] .'</small></div>'. "\n" : '' );					$content .= '</div><br class="clear">'. "\n";					$content .= "<script type='text/javascript'>jQuery(document).ready(function($) { $('#". $id ." span.add-account').gaeNewAccount({ master : 'account-master', theId: '$theme_id' }); });</script><style type='text/css'>#gaeframework .account-title span.edit { background-image: url('images/arrows.png'); } #gaeframework .account-title:hover > span.edit, #gaeframework .account-title.show span.edit { background-image: url('images/arrows-dark.png'); }</style>". "\n";					$content .= '<div class="account-master hidden"><h4 class="account-title hidden account-the__id__ show" onclick="gaeEditAccount(the__id__);">'. __('New Account', 'gaetheme') .'<span class="edit hide-if-no-js"></span><span class="remove hide-if-no-js"><a class="account-the__id__" onclick="gaeDelAccount(the__id__);">'. __('Remove', 'gaetheme') .'</a></span></h4><div class="account-data hidden account-the__id__" style="display:block;"><ul><li class="odd"><label for="account-name-the__id__">'. __('Name', 'gaetheme') .'</label></li><li class="even"><input id="account-name-the__id__" class="social-name text" type="text" name="__name__name__"></li></ul><ul><li class="odd"><label for="account-url-the__id__">'. __('URL', 'gaetheme') .'</label></li><li class="even"><input id="account-url-the__id__" class="social-url text" type="text" name="__url__name__"></li></ul><ul><li class="odd"><label for="account-icon-the__id__">'. __('Icon', 'gaetheme') .'</label></li><li class="even"><input id="account-icon-the__id__" class="social-icon text" type="text" name="__icon__name__"></li></ul><br class="clear"></div></div>';				break;						case "info":					$content .= '<p class="howto element">'. ( isset($value['desc']) ? $value['desc'] : '' ) .'</p>'. "\n";				break;						}		}	?>	<div id="gaeframework" class="wrap">		<?php screen_icon( !empty($this->_gae_panel['icon']) ? $this->_gae_panel['icon'] : 'themes' ); ?>		<h2><?php echo $this->_gae_panel['title']; ?></h2>		<?php			if ( $this->_gae_panel['key'] == 'seo' & get_option( 'blog_public') == 0 ) {				echo gae_message_setting( sprintf( __('This site is set to private. If you want to enable SEO settings, change the privacy settings %s', 'gaetheme'), '<a href="'. admin_url( 'options-privacy.php' ) .'">'. __('here', 'gaetheme') .'</a>' ), 'error' );			}			if ( array_key_exists('settings-updated', $_REQUEST) ) {				if ( $_REQUEST['settings-updated'] == 'false' ) {					echo gae_message_setting( __('Settings reseted.', 'gaetheme') );				} elseif ( $_REQUEST['settings-updated'] == 'true' ) {					echo gae_message_setting( __('Settings saved.', 'gaetheme') );				}			}		?>		<div id="<?php echo $this->_gae_panel['key']; ?>-option" class="option-wrap">			<form method="post" action="options.php">			<?php settings_fields( $shortname.'_options_'.$this->_gae_panel['key'] ); ?>				<div class="form-header">					<?php submit_button( __('Save Changes', 'gaetheme'), 'primary', 'update', false, '' ); ?>				</div>				<div class="form-area">					<div class="panelback"></div>					<ul class="tab-panel">						<?php echo $nav; ?>					</ul>					<div class="form-content">							<?php echo $content; ?>						<br class="clear">					</div>				</div>				<br class="clear">				<div class="form-footer">					<p class="copyright">&copy; <?php echo '2011-'. date('Y'); ?> <a href="http://www.gaetheme.com">GaeTheme.com</a></p>					<span id="reset-button" class="button red-button hide-if-no-js"><?php _e('Reset Settings', 'gaetheme'); ?></span>					<?php submit_button( __('Save Changes', 'gaetheme'), 'primary', 'update', false, '' ); ?>				</div>			</form>		</div>	</div>	<?php	}	function add_scripts() {		global $pagenow;		if( $pagenow != 'admin.php' ) return;		if( $_GET['page'] == $this->_gae_panel['id'] ) :			?>			<script type="text/javascript">			jQuery(document).ready(function($) {				$('#<?php echo $this->_gae_panel['key']; ?>-option #reset-button').gaeReset({					redirect	: '?page=<?php echo $this->_gae_panel['id']; ?>&settings-updated=false',					confirm		: '<?php _e('Are you sure to reset all the settings and restored to default value?', 'gaetheme'); ?>'				});				$('#<?php echo $this->_gae_panel['key']; ?>-option').gaeTabs();			});			</script>			<?php		endif;	}	function options_remove() {		global $shortname;		delete_option( $shortname.'_options_'.$this->_gae_panel['key'] );	}}/*------------------------------------------------------------------	2 - Theme Collections------------------------------------------------------------------*/class Gae_Themes_Show {		protected $_gae_panel;	function __construct($themes_show) {		$this->_gae_panel = $themes_show;		add_action('admin_menu', array(&$this, 'add_submenu'));		add_action('wp_before_admin_bar_render', array(&$this, 'add_admin_bar'));	}	    function add_submenu() {		add_submenu_page( $this->_gae_panel['parent'], $this->_gae_panel['title'], $this->_gae_panel['page'], $this->_gae_panel['capability'], $this->_gae_panel['id'], array(&$this, 'display_page') );	}	function add_admin_bar() {		global $wp_admin_bar, $themename;		if ( is_admin() || !is_admin_bar_showing() || !current_user_can($this->_gae_panel['capability']) ) return;		$wp_admin_bar->add_menu( array( 'id' => $this->_gae_panel['id'] .'-'. $this->_gae_panel['key'], 'parent' => ($wp_admin_bar->get_node($this->_gae_panel['parent']) ? $this->_gae_panel['parent'] : 'site-name'), 'title' => $this->_gae_panel['page'], 'href' => admin_url('admin.php?page='. $this->_gae_panel['id']) ) );	}	function display_page() {		$theme_data = get_transient($this->_gae_panel['key']);		if ( ! $theme_data ) {			$html = '';			include_once( ABSPATH . WPINC . '/feed.php' );			$rss = fetch_feed( 'http://www.gaetheme.com/feed/' );			if ( is_wp_error($rss) ) {				echo '<div class="updated fade"><p>' . sprintf( __( '<strong>RSS Error</strong>: (%s)', 'gaetheme' ), '<code>' . $rss->get_error_message() . '</code>' ) . '</p></div>';				return;			}			$items = $rss->get_items( 0, 18 );			if ( empty( $items ) )  {				$html .= '<li>No items</li>';			} else {				foreach ( $items as $item ) {					$urls = explode(',', $item->get_content());					$html .= '<div class="available-theme">' . "\n";					$html .= '<a class="screenshot" title="View &quot;' . $item->get_title() . '&quot;" href="' . $urls[1] . '"><img src="' . $urls[0] . '" alt="' . $item->get_title() . '" /></a>' . "\n";					$html .= '<h3>' . $item->get_title() . '</h3>' . "\n";					$html .= '<p class="description">Released: ' . $item->get_date(get_option('date_format')) . '.</p>' . "\n";					$html .= '<span class="action-links">';					$html .= '<a title="Visit ' . $item->get_title() . ' Homepage" href="' . $item->get_permalink() . '" target="_blank">Detail</a>';					$html .= ' | ';					$html .= '<a title="Visit ' . $item->get_title() . ' Demo" href="' . $urls[1] . '">Preview</a>';					$html .= '</span>' . "\n";					$html .= '<p>Tags: ' . $item->get_description() . '</p>' . "\n";					$html .= '</div>' . "\n";				}												// Cache this data for 7 days.				set_transient($this->_gae_panel['key'], $html , 7*60*60*24);			}						// Set the theme data to be displayed.			$theme_data = $html;		}	?>	<div class="wrap">		<?php screen_icon( !empty($this->_gae_panel['icon']) ? $this->_gae_panel['icon'] : 'themes' ); ?>		<h2><?php echo $this->_gae_panel['title']; ?></h2>		<form class="search-form filter-form" method="get" action="http://www.gaetheme.com/">			<p class="search-box">			<input id="theme-search-input" type="text" value="" name="s">			<input id="search-submit" class="button" type="submit" value="<?php _e('Search Themes', 'gaetheme'); ?>" name="">			</p>		</form>		<br class="clear"/>		<div id="availablethemes">			<?php echo $theme_data; ?>		</div>	</div>	<?php	}}/*------------------------------------------------------------------	3 - Shortcode Generator------------------------------------------------------------------*/class Gae_Shortcode_Gen {		protected $_gae_panel;	function __construct($sc_gen) {		$this->_gae_panel = $sc_gen;		add_action('admin_init', array(&$this, 'load_scripts'));		add_action('admin_menu', array(&$this, 'add_submenu'));		add_action('wp_before_admin_bar_render', array(&$this, 'add_admin_bar'));		add_action('in_admin_footer', array(&$this, 'add_scripts'));	}		function load_scripts(){		global $pagenow;		if( $pagenow != 'admin.php' ) return;		if( $_GET['page'] == $this->_gae_panel['id'] ) :			wp_enqueue_script( 'jquery' );			wp_enqueue_script( 'farbtastic' );			wp_enqueue_script( 'jquery-admin-generator', get_theme_uri('functions, gaepanel, js') . '/jquery.generator.js', '', '' );			wp_enqueue_script( 'admin-options', get_theme_uri('functions, gaepanel, js') . '/jquery.options.js', '', '1' );			wp_enqueue_style( 'farbtastic' );			wp_enqueue_style( 'gaepanel', get_theme_uri('functions, gaepanel, css') . '/gaepanel.css', '', '1', false, 'screen');		endif;	}	    function add_submenu() {		add_submenu_page( $this->_gae_panel['parent'], $this->_gae_panel['title'], $this->_gae_panel['page'], $this->_gae_panel['capability'], $this->_gae_panel['id'], array(&$this, 'display_page') );	}	function add_admin_bar() {		global $wp_admin_bar, $themename;		if ( is_admin() || !is_admin_bar_showing() || !current_user_can($this->_gae_panel['capability']) ) return;		$wp_admin_bar->add_menu( array( 'id' => $this->_gae_panel['id'] .'-'. $this->_gae_panel['key'], 'parent' => ($wp_admin_bar->get_node($this->_gae_panel['parent']) ? $this->_gae_panel['parent'] : 'new-content'), 'title' => $this->_gae_panel['page'], 'href' => admin_url('admin.php?page='. $this->_gae_panel['id']) ) );	}	function display_page() {		$content = '<div class="tab-content" id="landing-shortcode">'. "\n";		$content .= '<h3 class="title">'. __('Shortcodes','gaetheme') .'</h3>'. "\n";		$content .= '<p>'. __('Please select the shortcode to begin generate.','gaetheme') .'</p>'. "\n";		$content .= '</div>'. "\n";						foreach ($this->_gae_panel['options'] as $value) {			$val_id 	= ( isset($value['id']) ) ? $value['id'] : '';			$val_name	= ( isset($value['name']) ) ? $value['name'] : '';			$val_class	= ( isset($value['class']) ) ? $value['class'] : '';			$val_std 	= ( isset($value['std']) ) ? $value['std'] : '';						$names = explode('_', $val_id);			if ( count($names) > 1 ) { $main = trim($names[0]); $name = trim($names[1]); }			else { $main = $names; $name = ''; }			if( $name != 'content' ) { $add_class = ' attribute'; }			else { $add_class = ''; }						switch ( $value['type'] ) {								case "tab_begin":					$content .= '<div class="tab-content hidden" id="'. $val_id .'-shortcode">'. "\n";					$content .= '<h3 class="title">'. sprintf( __('"%s" Shortcode', 'gaetheme'), $val_name ) .'</h3>'. "\n";				break;				case "tab_end":					$content .= '<ul class="element">'. "\n";					$content .= '<li class="odd">&nbsp;</li>'. "\n";					$content .= '<li class="even"><input type="submit" value="'. __('Generate', 'gaetheme') .'" class="button-secondary" id="'. $val_id .'" name="generate"></li>'. "\n";					$content .= '</ul><br class="clear">'. "\n";					$content .= '<ul class="element">'. "\n";					$content .= '<li class="odd"><label for="'. $val_id .'_code">'. __('Shortcode', 'gaetheme') .'</label></li>'. "\n";					$content .= '<li class="even"><textarea id="'. $val_id .'_code" rows="5" readonly="readonly" class="textarea widefat code"></textarea></li>'. "\n";					$content .= '</ul><br class="clear">'. "\n";					$content .= '</div>'. "\n";				break;				case "text":					$content .= '<ul class="element">'. "\n";					$content .= '<li class="odd"><label for="'. $val_id .'">'. $val_name .'</label></li>'. "\n";					$content .= '<li class="even"><input class="text'. $add_class .' '. $val_class .'" type="text" name="'. $name .'" id="'. $val_id .'" /></li>'. "\n";					$content .= '</ul><br class="clear">'. "\n";				break;				case "number":					$content .= '<ul class="element">'. "\n";					$content .= '<li class="odd"><label for="'. $val_id .'">'. $val_name .'</label></li>'. "\n";					$content .= '<li class="even"><input class="number'. $add_class .'" type="text" name="'. $name .'" id="'. $val_id .'" value="'. $val_std .'" /></li>'. "\n";					$content .= '</ul><br class="clear">'. "\n";				break;				case "color":					$content .= '<ul class="element">'. "\n";					$content .= '<li class="odd"><label for="'. $val_id .'">'. $val_name .'</label></li>'. "\n";					$content .= '<li class="even"><div class="'. $val_id .'">'. "\n";					$content .= '<input class="color-value '. $add_class .'" type="text" name="'. $name .'" id="'. $val_id .'" value="#" />'. "\n";					$content .= '<input class="color-preview " type="button" />'. "\n";					$content .= '<input class="color-select" type="button" value="'. __('Select a Color', 'gaetheme') .'" />';					$content .= '<input class="color-remove" type="button" value="'. __('Clear', 'gaetheme') .'" />';					$content .= '<div class="colorpicker"></div>'. "\n";					$content .= '</div></li>'. "\n";					$content .= '</ul><br class="clear">'. "\n";					$content .= "<script type='text/javascript'>jQuery(document).ready(function($) { jQuery('.". $val_id ."').gaeColor({pickClass : 'colorpicker'}); });</script>";				break;				case "textarea":					$content .= '<ul class="element">'. "\n";					$content .= '<li class="odd"><label for="'. $val_id .'">'. $val_name .'</label></li>'. "\n";					$content .= '<li class="even"><textarea class="textarea widefat'. $add_class .'" id="'. $val_id .'" rows="5" name="'. $name .'"></textarea></li>'. "\n";					$content .= '</ul><br class="clear">'. "\n";				break;				case "select":					$content .= '<ul class="element">'. "\n";					$content .= '<li class="odd"><label for="'. $val_id .'">'. $val_name .'</label></li>'. "\n";					$content .= '<li class="even"><select class="select'. $add_class .'" name="'. $name .'" id="'. $val_id .'">'. "\n";					foreach ($value['options'] as $get_opt) {						$id_value = str_replace(',','',str_replace(' ','_',strtolower($get_opt)));						$content .= '<option value="'. $id_value .'"'. ( ($val_std == $id_value) ? ' selected="selected"' : '' ) .'>'. $get_opt .'</option>'. "\n";					}					$content .= '</select></li>'. "\n";					$content .= '</ul><br class="clear">'. "\n";				break;				case "radio":					$content .= '<ul class="element">'. "\n";					$content .= '<li class="odd"><label for="'. $val_id .'">'. $val_name .'</label></li>'. "\n";					$content .= '<li class="even">'. "\n";					$content .= '<ul class="radio">'. "\n";					foreach ($value['options'] as $get_opt) {						$id_value = str_replace(' ','_',strtolower($get_opt));						$content .= '<li>';						$content .= '<input type="radio" name="'. $name .'" class="'. $val_id . $add_class .'" value="'. $id_value .'" id="'. $id_value .'"'. ( ($val_std == $id_value) ? ' checked="yes"' : '' ) .'/> <label for="'.$id_value .'">';						$content .= '<img src="'. get_theme_uri('functions, asset, images, shortcode, list') .'/'. $id_value .'.png" alt="'. $get_opt .'" />';						$content .= $get_opt;						$content .= '</label>';						$content .= '</li>'. "\n";					}					$content .= '</ul>'. "\n";					$content .= '</li>'. "\n";					$content .= '</ul><br class="clear">'. "\n";				break;				case "thickbox":					$content .= $this->thickbox($value['options']);				break;				case "desc":					$content .= '<p class="element howto">'. $value['desc'] .'</p>'. "\n";				break;			}		}	?>	<div id="gaeframework" class="wrap">		<?php screen_icon( !empty($this->_gae_panel['icon']) ? $this->_gae_panel['icon'] : 'themes' ); ?>		<h2><?php echo $this->_gae_panel['title']; ?></h2>		<?php			echo gae_message_setting( __('It appears that JavaScript is disabled in your web browser. Please enable it to use the functions on this panel.', 'gaetheme'), 'error hide-if-js' );		?>		<div id="<?php echo $this->_gae_panel['key']; ?>-option" class="option-wrap hide-if-no-js">			<div class="form-header">			</div>			<div class="form-area">				<div class="panelback"></div>					<?php echo $this->shortcodes(); ?>				<div class="form-content">						<?php echo $this->thumbnails(); ?>					<?php echo $content; ?>					<br class="clear">				</div>			</div>			<br class="clear">			<div class="form-footer">				<p class="copyright">&copy; <?php echo '2011-'. date('Y'); ?> <a href="http://www.gaetheme.com">GaeTheme.com</a></p>			</div>		</div>	</div>	<?php	}	function shortcodes($display = 'list') {			$wrap = ($display == 'select') ? 'select' : 'ul';		$list = ($display == 'select') ? 'option' : 'li';		$var  = ($display == 'select') ? 'value' : 'id';		$shortcodes = array();		foreach ($this->_gae_panel['options'] as $value) {			if ( $value['type'] == 'tab_begin' ) {				$shortcodes[] = array('id' => $value['id'], 'name' => $value['name']);			}		}		$content = '';		if ( $display == 'select' ) $content .= '<'. $list .' value="#">'. sprintf( __('%1$s Select %2$s','gaetheme'), '&mdash;', '&mdash;' ) .'</'. $list .'>';		$i = 1;		foreach ($shortcodes as $shortcode) {			$content .= '<'. $list .' '. $var .'="'. $shortcode['id'] .'"'. ( ($display == 'list') ? ' class="'. ( ($i%2==0) ? 'even' : 'odd' ) .'"><a href="#'. $shortcode['id'] .'">' : '>' ) . $shortcode['name'] . ( ($display == 'list') ? '</a>' : '' ) .'</'. $list .'>';			$i = $i+1;		}		return '<'. $wrap .' id="shortcode-'. $display .'">'. $content .'</'. $wrap .'>';	}		function thumbnails() {		$content = '';		foreach ($this->_gae_panel['options'] as $value) {			if ( isset($value['thumb']) ) {				$thumb_id = $value['thumb'];				if ( isset($value['thumb_desc']) ) $thumb_title = $value['thumb_desc'];					else $thumb_title = $value['name'];					$content .= '<div class="'. $thumb_id .'-thumbnails shortcode-thumbnails hidden">'. "\n";					$content .= '<div id="'. $thumb_id .'-thumbnails" class="thumbnail-content">';					$content .= '<ul class="'. $thumb_id .'-thumbs thumbs">'. "\n";					if ( isset($value['options']) ) {						foreach ($value['options'] as $get_opt) {							$id_value = str_replace(' ','_',strtolower($get_opt));							$img_location = get_theme_uri('functions, gaepanel, images, thumbs') .'/'. $thumb_id .'/'. $id_value .'.png';							$content .= '<li>'. "\n";							$content .= '<a href="'. $img_location .'" target="_blank"><img src="'. $img_location .'" alt="'. $get_opt .'" /></a>';							$content .= $get_opt;							$content .= '</li>'. "\n";						}					} else {						$img_location = get_theme_uri('functions, gaepanel, images, thumbs') .'/'. $thumb_id .'/'. $value['id'] .'.png';						$content .= '<li>'. "\n";						$content .= '<a href="'. $img_location .'" target="_blank"><img src="'. $img_location .'" alt="'. $value['name'] .'" /></a>';						$content .= $value['name'];						$content .= '</li>'. "\n";					}					$content .= '</ul>'. "\n";					$content .= '<p><small>'. __('The image might be resized, click image for full preview!', 'gaetheme') .'</small></p>'. "\n";					$content .= '</div>';					$content .= '<div class="show-thumbnails"><a href="#'. $thumb_id .'-thumbnails">'. $thumb_title .'</a></div>';					$content .= '<br class="clear"></div>'. "\n";			}		}		return $content;	}	function thickbox($options = array()) {			$content = '';				foreach ($options as $value) {			$val_id 	= ( isset($value['id']) ) ? $value['id'] : '';			$val_name	= ( isset($value['name']) ) ? $value['name'] : '';			$val_class	= ( isset($value['class']) ) ? $value['class'] : '';			$val_group	= ( isset($value['group']) ) ? $value['group'] : '';			$val_std	= ( isset($value['std']) ) ? $value['std'] : '';						if( $val_id != 'content' ) $add_class = ' attribute';				else $add_class = '';							switch ( $value['type'] ) {							case "text":					$content .= '<ul class="element thickbox_group '. $val_group .'" valign="top">'. "\n";					$content .= '<li class="odd"><label for="thickbox_'. $val_id .'">'. $val_name .'</label></li>'. "\n";					$content .= '<li class="even"><input class="text '. $add_class .' '. $val_class .' '. $val_group .'" type="text" name="" id="'. $val_id .'" /></li>'. "\n";					$content .= '</ul><br class="clear thickbox_group '. $val_group .'">'. "\n";				break;				case "number":					$content .= '<ul class="element thickbox_group '. $val_group .'" valign="top">'. "\n";					$content .= '<li class="odd"><label for="thickbox_'. $val_id .'">'. $val_name .'</label></li>'. "\n";					$content .= '<li class="even"><input class="number '. $add_class .' '. $val_group .'" type="text" name="" id="'. $val_id .'" value="'. $val_std .'" /></li>'. "\n";					$content .= '</ul><br class="clear thickbox_group '. $val_group .'">'. "\n";				break;				case "textarea":					$content .= '<ul class="element thickbox_group '. $val_group .'" valign="top">'. "\n";					$content .= '<li class="odd"><label for="thickbox_'. $val_id .'">'. $val_name .'</label></li>'. "\n";					$content .= '<li class="even"><textarea class="textarea widefat '. $val_group .'" id="'. $val_id .'" rows="5" name=""></textarea></li>'. "\n";					$content .= '</ul><br class="clear thickbox_group '. $val_group .'">'. "\n";				break;				case "info":					$content .= '<p class="element howto thickbox_group '. $val_group .'">'. $value['desc'] .'</p>'. "\n";				break;			}		}		return $content;	}	function add_scripts() {		global $pagenow;		if( $pagenow != 'admin.php' ) return;		if( $_GET['page'] == $this->_gae_panel['id'] ) :			?>			<style type="text/css">			<!--			.show-thumbnails a { background: url(images/arrows.png) right 3px no-repeat; }			.show-thumbnails a.active { background-position: right -33px; }			-->			</style>			<?php		endif;	}	}/*------------------------------------------------------------------	(c) GAETHEME.COM 2012------------------------------------------------------------------*/?>